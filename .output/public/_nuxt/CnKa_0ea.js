import{f as A,r as v,x as u,s as p}from"./CbOI5dCu.js";const L=()=>{const{$repo:{event:i,wallet:q},$config:{public:{APP_BASE_URL:$}}}=A(),f=v(!1),w=v(null),y=v(!1),c=v(!1),g=v(!1);return{fetchEventRequests:async e=>await i.getEventRequests(e),endEvent:async e=>{var s;try{f.value=!0;const a=await i.endEvent(e);f.value=!1,a.data&&u(`/events/${e}/event-earnings`)}catch(a){const r=a;f.value=!1,p({title:((s=r==null?void 0:r.data)==null?void 0:s.message)??"Failed to end event",variant:"warning"})}},ending:f,updateEventRequest:async(e,s,a)=>{var r;try{w.value=s,y.value=!0;const t=await i.updateEventRequest(e,s);p({title:t.message??"Updated"}),y.value=!1,w.value=null,t.data&&(a==null||a())}catch(t){const n=t;w.value=null,y.value=!1,p({title:((r=n==null?void 0:n.data)==null?void 0:r.message)??"Failed to update event",variant:"warning"})}},update_status:w,updating:y,createEventRequest:async(e,s)=>{var a,r,t,n;try{c.value=!0;const l=await i.createRequest(e),d=Number(l.data.price);return d?(c.value=!1,u(`/${s}/${e.event_id}/${l.data.id}/make-payment`)):(c.value=!1,u(`/${(r=(a=l.data)==null?void 0:a.host)==null?void 0:r.slug}`))}catch(o){const l=o;c.value=!1,p({title:((n=l==null?void 0:l.data)==null?void 0:n.message)??"Failed to create request",variant:"warning"})}},creating:c,payForRequest:async(e,s,a)=>{var r;try{let t="gateway";const n=Number(e.price);a&&(t=a>=n?"wallet":"split");const o=new URL(`${$}/${s}/${e.event_id}/${e.id}/request-receipt`),l=t==="wallet"?{redirect_url:o.href,type:t}:{redirect_url:o.href,type:t,gateway:"paystack"};g.value=!0;const d=await i.payForRequest(l,e.id);return g.value=!1,d.data.redirect_url?await u(d.data.redirect_url,{external:!0}):u(`/${s}/${e.event_id}/${e.id}/request-receipt`)}catch(t){const n=t;g.value=!1,p({title:((r=n==null?void 0:n.data)==null?void 0:r.message)??"Failed to pay for request",variant:"warning"})}},paying:g}};export{L as u};
