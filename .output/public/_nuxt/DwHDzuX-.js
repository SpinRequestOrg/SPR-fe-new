import{f as h,r as o,x as d,s as v}from"./CNW6Hso0.js";const b=()=>{const{$repo:{event:c,wallet:m},$config:{public:{APP_BASE_URL:R}}}=h(),p=o(!1),f=o(null),y=o(!1),i=o(!1),w=o(!1);return{fetchEventRequests:async e=>await c.getEventRequests(e),endEvent:async e=>{var l;try{p.value=!0;const a=await c.endEvent(e);p.value=!1,a.data&&d(`/events/${e}/event-earnings`)}catch(a){const r=a;p.value=!1,v({title:((l=r==null?void 0:r.data)==null?void 0:l.message)??"Failed to end event",variant:"warning"})}},ending:p,updateEventRequest:async(e,l,a)=>{var r;try{f.value=l,y.value=!0;const t=await c.updateEventRequest(e,l);v({title:t.message??"Updated"}),y.value=!1,f.value=null,t.data&&(a==null||a())}catch(t){const s=t;f.value=null,y.value=!1,v({title:((r=s==null?void 0:s.data)==null?void 0:r.message)??"Failed to update event",variant:"warning"})}},update_status:f,updating:y,createEventRequest:async(e,l)=>{var a,r,t;try{i.value=!0;const n=await c.createRequest(e),g=Number(n.data.price);return g?(i.value=!1,d(`/${l}/${e.event_id}/${n.data.id}/make-payment`)):(i.value=!1,d(`/${(r=(a=n.data)==null?void 0:a.host)==null?void 0:r.slug}`))}catch(s){const n=s;i.value=!1,v({title:((t=n==null?void 0:n.data)==null?void 0:t.message)??"Failed to create request",variant:"warning"})}},creating:i,payForRequest:async(e,l,a)=>{var r;try{let t="gateway";const s=Number(e.price);a&&(t=a>=s?"wallet":"split");const n=new URL(`${R}/${l}/${e.event_id}/${e.id}/request-receipt`),g=t==="wallet"?{redirect_url:n.href,type:t}:{redirect_url:n.href,type:t,gateway:"paystack"};w.value=!0;const u=await c.payForRequest(g,e.id);w.value=!1,u.data.redirect_url&&await d(u.data.redirect_url,{external:!0})}catch(t){const s=t;w.value=!1,v({title:((r=s==null?void 0:s.data)==null?void 0:r.message)??"Failed to pay for request",variant:"warning"})}},paying:w}};export{b as u};
