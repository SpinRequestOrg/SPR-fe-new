import{_ as H}from"./-_GNoFr9.js";import{h as A,i as P,j as h,o as m,p as B,w as d,b as i,a as s,c as x,z as j,t as y,n as t,$ as D,a0 as U,a1 as Y,v as I,A as O,F as W,L as Z,W as G,Y as J,Z as K,k as Q,m as X,a2 as tt,d as N,_ as et}from"./CNW6Hso0.js";import{_ as ot}from"./D8FlHw4v.js";import{_ as st}from"./Dn6XevqU.js";import{_ as T}from"./QD02WEmo.js";import{m as at}from"./ucNmIr38.js";import{_ as nt}from"./BbpJ2SlF.js";import{u as k}from"./DCLVAHNd.js";import"./DYqBtWVj.js";import"./DA6PwBCs.js";import"./Czt-PC2x.js";import"./Cpj98o6Y.js";import"./FtHhDDcH.js";import"./DzR8TcQu.js";import"./CE7Rug1F.js";const it={class:"grid grid-cols-[auto,_1fr,_auto] gap-4 items-center my-8"},rt={class:"flex gap-x-4 items-center"},lt={class:"relative bg-foreground size-[30px] rounded-full"},ct={class:"place-center text-lg font-bold text-background"},dt={class:"space-y-px"},ut={key:0,class:"text-[#FFEE99]"},mt={class:"font-semibold"},_t={key:0,class:"py-20 absolute -top-2 inset-0 grid place-items-center"},pt=A({__name:"event-top-spenders",props:{spenders:{default:()=>at},loading:{type:Boolean,default:!1}},setup(C){const n=C,_=a=>{a.preventDefault()},{authEmail:p}=P(),$=h(()=>{if(!(n!=null&&n.spenders))return[];const a=n.spenders.map((o,e)=>({...o,position:e+1,active:o.email===p.value,name:(o==null?void 0:o.name)??(o==null?void 0:o.email)??""})),l=a.find(o=>o.email===p.value),r=a.slice(0,6),c=!!l&&r.some(o=>o.email===p.value);return l&&!c&&r.splice(r.length-1,1,l),r});return(a,l)=>{const r=G,c=J,o=K;return m(),B(o,null,{default:d(()=>[i(c,{class:"relative"},{default:d(()=>[l[0]||(l[0]=s("div",{class:"font-display text-3xl font-bold pb-4 border-b border-input"}," Top Spenders ",-1)),(m(!0),x(W,null,j(t($),(e,S)=>(m(),B(r,{key:e.user_id+e.email,value:e.user_id+e.email,onSelect:_},{default:d(()=>{var f;return[s("div",it,[s("div",rt,[s("div",lt,[s("div",ct,y(e.position),1)]),i(nt,{initials:("getInitials"in a?a.getInitials:t(D))(e.name),class:"font-bold text-lg",style:U({backgroundColor:("getHexColor"in a?a.getHexColor:t(Y))(((f=e==null?void 0:e.name)==null?void 0:f.charAt(0))??"A"),color:"black"})},null,8,["initials","style"])]),s("div",dt,[s("div",null,y(e.name),1),e.active?(m(),x("div",ut,"You")):I("",!0)]),s("div",mt," â‚¦"+y(("formatMoney"in a?a.formatMoney:t(O))((e==null?void 0:e.total)??0)),1)])]}),_:2},1032,["value"]))),128)),a.loading?(m(),x("div",_t,[i(t(Z),{class:"size-4 animate-spin"})])):I("",!0)]),_:1})]),_:1})}}}),ft={class:"container pb-20"},vt={class:"place-center text-center grid place-items-center gap-4"},gt={class:"text-destructive text-clip"},ht={class:"grid grid-cols-1 lg:grid-cols-[1fr_400px] gap-x-20 gap-y-6 mt-20"},xt={class:"absolute w-[450px] h-0 overflow-hidden"},yt={class:"flex justify-center my-4"},wt=A({__name:"request-receipt",setup(C){var E;const n=Q(),{data:_,status:p,error:$}=k(`events/${n.params.event_id}`),a=((E=n==null?void 0:n.query)==null?void 0:E.reference)??"",{data:l,status:r,error:c,refresh:o}=k(`transactions/${a}/verify`),{data:e,status:S}=k(`/events/top/spenders/${n.params.event_id}?includeLiveEvent=1`),f=h(()=>p.value==="pending"||r.value==="pending"),R=h(()=>$.value??c.value),F=n.params.request_id,q=h(()=>{var b;return(b=_.value)==null?void 0:b.data.requests.find(u=>`${u.id}`==`${F}`)});return X({title:"Request Receipt"}),(b,u)=>{const w=H,z=et,M=ot,V=st;return m(),x("div",ft,[i(w,{class:"fixed top-20",to:`/${t(n).params.host}`},null,8,["to"]),i(V,{loading:t(f),error:t(R)},tt({default:d(()=>{var v,g,L;return[s("div",ht,[s("div",null,[i(T,{request:t(q),event:(v=t(_))==null?void 0:v.data},null,8,["request","event"]),s("div",xt,[i(T,{request:t(q),event:(g=t(_))==null?void 0:g.data,print:"",id:"RECEIPT_PRINT"},null,8,["request","event"])]),s("div",yt,[i(M,{to:`/${t(n).params.host}`,class:"underline hover:no-underline"},{default:d(()=>u[1]||(u[1]=[N(" CONTINUE ")])),_:1},8,["to"])])]),s("div",null,[i(pt,{loading:t(S)==="pending",spenders:((L=t(e))==null?void 0:L.data)??[]},null,8,["loading","spenders"])])])]}),_:2},[t(c)?{name:"error",fn:d(()=>{var v,g;return[s("div",vt,[s("div",gt,y(((g=(v=t(c))==null?void 0:v.data)==null?void 0:g.message)??"Payment verification failed"),1),i(z,{variant:"outline",onClick:t(o),loading:t(f)},{default:d(()=>u[0]||(u[0]=[N(" Confirm agai ")])),_:1},8,["onClick","loading"])])]}),key:"0"}:void 0]),1032,["loading","error"])])}}});export{wt as default};
