import{_ as J}from"./iZtZZNnV.js";import{h as H,j as S,o as l,c as v,a as t,R as T,m as s,S as z,t as m,b as a,O as j,F as A,Q as V,w as d,d as D,n as F,q as P,_ as O,i as Q,a6 as X,a7 as Z,a8 as G,L as K,Y as W,Z as ee,$ as te,k as se,a9 as oe}from"./nPKPItbM.js";import{_ as ne}from"./DuZ3zr3E.js";import{_ as ae}from"./BvZXc05T.js";import{_ as ie}from"./DOZRkeBF.js";import{_ as re,m as le}from"./Co9wB_1n.js";import{_ as de}from"./kDtV_XTV.js";import{u as ce,a as ue,F as me}from"./BUFsxhfj.js";import{C as pe,a as _e}from"./BqQLsKcb.js";import{u as fe}from"./DoCL3I8U.js";import{_ as ve}from"./Cy_720vS.js";import{u as Y}from"./C6pbb5ow.js";import{u as ge}from"./BQfFxr_E.js";import"./IAlq6qwQ.js";import"./Cpj98o6Y.js";const ye={class:"font-display text-3xl font-medium capitalize"},he={class:"space-y-4 my-4"},xe={class:"py-4 px-6 grid grid-cols-[repeat(auto-fit,_minmax(300px,_1fr))] gap-4 border bg-white/5 rounded-2xl"},be={class:"space-y-1"},$e={class:"text-4xl font-semibold text-primary"},ke={class:"space-y-px"},qe={class:"font-medium"},Se={class:"grid grid-cols-[repeat(auto-fit,_minmax(300px,_1fr))] gap-4"},Ce={class:"space-y-px"},we={class:"text-muted-foreground"},Ie={key:0,class:"grid grid-cols-[1fr,_auto,_auto,_auto] gap-4 items-center"},Re="https://dev.spinrequest.com",U=H({__name:"request-receipt-item",props:{request:{},event:{},print:{type:Boolean}},setup(E){const n=E,b=S(()=>{var _,f,u,q;const e={name:"Event",value:(_=n.event)==null?void 0:_.title},o={name:"Host",value:(f=n.request)==null?void 0:f.host.stage_name},k={name:"Location",value:(u=n.event)==null?void 0:u.address},w={name:"Date",value:fe((q=n.event)==null?void 0:q.start_date,"dddd, MMMM D, YYYY")};return[e,o,k,w]}),$=e=>{var o;me.saveAs(e,`spin-request-receipt-${(o=n.event)==null?void 0:o.title}`)},{converting:I,convertNodeToImage:r}=ce("#RECEIPT_PRINT",$),g=S(()=>{var e,o;return`I just made a ${((e=n.request)==null?void 0:e.type)??"song"} request on SpinRequest. Join ${(o=n.request)==null?void 0:o.host.stage_name} live event to make yours.`}),p=S(()=>{var e;return`${Re}/${((e=n.request)==null?void 0:e.host.slug)??""}`}),{copyLink:y,copied:c,whatsappShareLink:i,twitterShareLink:L,externalNavigate:C}=ue(p,g);return(e,o)=>{var u,q,N,B,M,h,x;const k=ie,w=re,_=O,f=de;return l(),v("div",{class:T(("cn"in e?e.cn:s(z))(" rounded-xl",e.print?"p-4 border-2 border-primary bg-background":"p-4 md:p-8 bg-white/5"))},[t("div",{class:T(("cn"in e?e.cn:s(z))("flex flex-col items-center gap-6",e.print?"":"md:flex-row md:justify-between"))},[t("div",{class:T(("cn"in e?e.cn:s(z))("text-center order-2",e.print?"":"md:text-left md:order-1"))},[t("div",ye,m((u=e.request)==null?void 0:u.type)+" Request receipt ",1),t("div",{class:T(("cn"in e?e.cn:s(z))("text-muted-foreground leading-tight my-2",e.print?"":"md:w-3/4"))},m(((q=e.request)==null?void 0:q.type)==="hype"?"Your request has been submitted, we will notify you when your hype has been performed":"Your request has been submitted, we will notify you when your song has been played"),3)],2),t("div",{class:T(("cn"in e?e.cn:s(z))("flex items-center shrink-0 text-primary gap-x-1 order-1",e.print?"":"md:order-2"))},[a(k,{name:"spin-logo"}),o[2]||(o[2]=t("div",{class:"text-base font-medium"},"SpinRequest",-1))],2)],2),t("div",he,[t("div",xe,[t("div",be,[o[3]||(o[3]=t("div",{class:"text-muted-foreground"},"Total amount",-1)),t("div",$e," ₦"+m(("formatMoney"in e?e.formatMoney:s(j))(((N=e.request)==null?void 0:N.price)??0)),1)]),t("div",ke,[((B=e.request)==null?void 0:B.type)==="hype"?(l(),v(A,{key:0},[o[4]||(o[4]=t("div",{class:"text-muted-foreground"},"Hype request for",-1)),a(w,{class:"font-medium",content:((M=e.request)==null?void 0:M.description)??""},null,8,["content"])],64)):(l(),v(A,{key:1},[o[5]||(o[5]=t("div",{class:"text-muted-foreground"},"Song title",-1)),t("div",qe,m(((h=e.request)==null?void 0:h.song_title)??""),1),t("div",null,"by "+m(((x=e.request)==null?void 0:x.artist)??""),1)],64))])]),t("div",Se,[(l(!0),v(A,null,V(s(b),R=>(l(),v("div",{class:"p-4 rounded-2xl bg-white/5 border",key:R.name},[t("div",Ce,[t("div",we,m(R.name),1),t("div",null,m(R.value),1)])]))),128))]),e.print?P("",!0):(l(),v("div",Ie,[a(_,{size:"lg",class:"uppercase",loading:s(I),onClick:s(r)},{default:d(()=>o[6]||(o[6]=[D(" Download Receipt "),t("span",{class:"hidden md:inline ml-1"}," & loud IT",-1)])),_:1},8,["loading","onClick"]),a(f,{message:"Share to twitter/X"},{default:d(()=>[a(_,{size:"icon",variant:"secondary",class:"!size-[40px]",onClick:o[0]||(o[0]=R=>s(C)(s(L)))},{default:d(()=>[a(k,{name:"x"})]),_:1})]),_:1}),a(f,{message:"Share to whatsapp"},{default:d(()=>[a(_,{size:"icon",variant:"secondary",class:"!size-[40px]",onClick:o[1]||(o[1]=R=>s(C)(s(i)))},{default:d(()=>[a(k,{name:"whatsapp",class:"scale-[0.7]"})]),_:1})]),_:1}),a(f,{message:"Copy link"},{default:d(()=>[a(_,{size:"icon",variant:"secondary",class:"!size-[40px]",onClick:s(y)},{default:d(()=>[s(c)?(l(),F(s(pe),{key:0,class:"text-muted-foreground size-4"})):(l(),F(s(_e),{key:1,class:"text-muted-foreground size-4"}))]),_:1},8,["onClick"])]),_:1})]))])],2)}}}),Te={class:"grid grid-cols-[40px,_1fr,_150px] gap-4 items-center my-8"},ze={class:"space-y-px"},Ee={key:0,class:"text-[#FFEE99]"},Le={class:"flex gap-x-4 items-center"},Ne={class:"relative bg-foreground size-[30px] rounded-full"},Be={class:"place-center text-lg font-bold text-background"},Me={class:"font-semibold"},Ae={key:0,class:"py-20 absolute -top-2 inset-0 grid place-items-center"},Fe=H({__name:"event-top-spenders",props:{spenders:{default:()=>le},loading:{type:Boolean,default:!1}},setup(E){const n=E,b=r=>{r.preventDefault()},{authEmail:$}=Q(),I=S(()=>{if(!(n!=null&&n.spenders))return[];const r=n.spenders.map((c,i)=>({...c,position:i+1,active:c.email===$.value})),g=r.find(c=>c.email===$.value),p=r.slice(0,6),y=!!g&&p.some(c=>c.email===$.value);return g&&!y&&p.splice(p.length-1,1,g),p});return(r,g)=>{const p=W,y=ee,c=te;return l(),F(c,null,{default:d(()=>[a(y,{class:"space-y-2 relative"},{default:d(()=>[g[0]||(g[0]=t("div",{class:"font-display text-3xl font-bold pb-4 border-b border-input mb-4"}," Top Spenders ",-1)),(l(!0),v(A,null,V(s(I),(i,L)=>(l(),F(p,{key:i.user_id+i.email,value:i.user_id+i.email,onSelect:b},{default:d(()=>{var C;return[t("div",Te,[a(ve,{initials:("getInitials"in r?r.getInitials:s(X))(i.name),class:"font-bold text-lg",style:Z({backgroundColor:("getHexColor"in r?r.getHexColor:s(G))(((C=i==null?void 0:i.name)==null?void 0:C.charAt(0))??"A"),color:"black"})},null,8,["initials","style"]),t("div",ze,[t("div",null,m(i.name),1),i.active?(l(),v("div",Ee,"You")):P("",!0)]),t("div",Le,[t("div",Ne,[t("div",Be,m(i.position),1)]),t("div",Me," ₦"+m(("formatMoney"in r?r.formatMoney:s(j))((i==null?void 0:i.total)??0)),1)])])]}),_:2},1032,["value"]))),128)),r.loading?(l(),v("div",Ae,[a(s(K),{class:"size-4 animate-spin"})])):P("",!0)]),_:1})]),_:1})}}}),Ye={class:"container pb-20"},De={class:"place-center text-center grid place-items-center gap-4"},Pe={class:"text-destructive"},He={class:"grid grid-cols-1 lg:grid-cols-[1fr_400px] gap-x-20 gap-y-6 mt-20"},Ue={class:"absolute w-[450px] h-0 overflow-hidden"},je={class:"flex justify-center my-4"},it=H({__name:"request-receipt",setup(E){var _;const n=se(),{data:b,status:$,error:I}=Y(`events/${n.params.event_id}`),r=((_=n==null?void 0:n.query)==null?void 0:_.reference)??"",{data:g,status:p,error:y,refresh:c}=Y(`transactions/${r}/verify`),{data:i,status:L,error:C}=Y(`/events/top/spenders/${n.params.event_id}`),e=S(()=>$.value==="pending"||p.value==="pending"),o=S(()=>I.value??y.value),k=n.params.request_id,w=S(()=>{var f;return(f=b.value)==null?void 0:f.data.requests.find(u=>`${u.id}`==`${k}`)});return ge({title:"Request Receipt"}),(f,u)=>{const q=J,N=O,B=ne,M=ae;return l(),v("div",Ye,[a(q,{class:"fixed top-20",to:`/${s(n).params.host}`},null,8,["to"]),a(M,{loading:s(e),error:s(o)},oe({default:d(()=>{var h,x;return[t("div",He,[t("div",null,[a(U,{request:s(w),event:(h=s(b))==null?void 0:h.data},null,8,["request","event"]),t("div",Ue,[a(U,{request:s(w),event:(x=s(b))==null?void 0:x.data,print:"",id:"RECEIPT_PRINT"},null,8,["request","event"])]),t("div",je,[a(B,{to:`/${s(n).params.host}`,class:"underline hover:no-underline"},{default:d(()=>u[1]||(u[1]=[D(" CONTINUE ")])),_:1},8,["to"])])]),t("div",null,[a(Fe,{loading:s(L)==="pending"},null,8,["loading"])])])]}),_:2},[s(y)?{name:"error",fn:d(()=>{var h,x;return[t("div",De,[t("div",Pe,m(((x=(h=s(y))==null?void 0:h.data)==null?void 0:x.message)??"Payment verification failed"),1),a(N,{variant:"outline",onClick:s(c),loading:s(e)},{default:d(()=>u[0]||(u[0]=[D(" Confirm again ")])),_:1},8,["onClick","loading"])])]}),key:"0"}:void 0]),1032,["loading","error"])])}}});export{it as default};
