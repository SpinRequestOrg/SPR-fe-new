import{f as A,r as v,x as i,s as p}from"./B3oCP8tS.js";const L=()=>{const{$repo:{event:u,wallet:q},$config:{public:{APP_BASE_URL:R}}}=A(),f=v(!1),w=v(null),y=v(!1),c=v(!1),g=v(!1);return{fetchEventRequests:async e=>await u.getEventRequests(e),endEvent:async e=>{var n;try{f.value=!0;const a=await u.endEvent(e);f.value=!1,a.data&&i(`/events/${e}/event-earnings`)}catch(a){const r=a;f.value=!1,p({title:((n=r==null?void 0:r.data)==null?void 0:n.message)??"Failed to end event",variant:"warning"})}},ending:f,updateEventRequest:async(e,n,a)=>{var r;try{w.value=n,y.value=!0;const t=await u.updateEventRequest(e,n);p({title:t.message??"Updated"}),y.value=!1,w.value=null,t.data&&(a==null||a())}catch(t){const s=t;w.value=null,y.value=!1,p({title:((r=s==null?void 0:s.data)==null?void 0:r.message)??"Failed to update event",variant:"warning"})}},update_status:w,updating:y,createEventRequest:async(e,n)=>{var a,r,t,s;try{c.value=!0;const l=await u.createRequest(e),d=Number(l.data.price);return d?(c.value=!1,i(`/${n}/${e.event_id}/${l.data.id}/make-payment`)):(c.value=!1,i(`/${(r=(a=l.data)==null?void 0:a.host)==null?void 0:r.slug}`))}catch(o){const l=o;c.value=!1,p({title:((s=l==null?void 0:l.data)==null?void 0:s.message)??"Failed to create request",variant:"warning"})}},creating:c,payForRequest:async(e,n,a)=>{var r;try{let t="gateway";const s=Number(e.price);a&&(t=a>=s?"wallet":"split");const o=new URL(`${R}/${n}/${e.event_id}/${e.id}/request-receipt`),l=t==="wallet"?{redirect_url:o.href,type:t}:{redirect_url:o.href,type:t,gateway:"paystack"};g.value=!0;const d=await u.payForRequest(l,e.id);return g.value=!1,d.data.redirect_url?await i(d.data.redirect_url,{external:!0}):i(`/${n}`)}catch(t){const s=t;g.value=!1,p({title:((r=s==null?void 0:s.data)==null?void 0:r.message)??"Failed to pay for request",variant:"warning"})}},paying:g}};export{L as u};
