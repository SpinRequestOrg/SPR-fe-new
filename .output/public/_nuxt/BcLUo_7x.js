import{_ as H}from"./OWLNppFj.js";import{h as w,i as U,j as x,o as m,p as B,w as d,b as i,a as s,c as y,E as j,t as b,n as t,Q as D,R as O,S as Q,v as I,z as Y,F as G,L as J,O as K,T as W,P as X,k as Z,l as tt,m as et,U as ot,d as N,_ as st}from"./B3oCP8tS.js";import{_ as at}from"./DMAhSTlz.js";import{_ as nt}from"./Ce61rJgB.js";import{_ as R}from"./D2NOmmLg.js";import{m as it}from"./CJILJlnD.js";import{_ as rt}from"./CdDTZ6NQ.js";import{u as k}from"./fJQd6cbo.js";import{p as lt}from"./P-jVyfhg.js";import"./jTEWzYvs.js";import"./DcJGATVt.js";import"./C7Fw_Uzz.js";import"./Cpj98o6Y.js";import"./CzavJOA3.js";import"./zID-tToP.js";import"./B9wSsAje.js";const ct={class:"grid grid-cols-[auto,_1fr,_auto] gap-4 items-center my-8"},dt={class:"flex gap-x-4 items-center"},ut={class:"relative bg-foreground size-[30px] rounded-full"},mt={class:"place-center text-lg font-bold text-background"},_t={class:"space-y-px"},pt={key:0,class:"text-[#FFEE99]"},ft={class:"font-semibold"},vt={key:0,class:"py-20 absolute -top-2 inset-0 grid place-items-center"},gt=w({__name:"event-top-spenders",props:{spenders:{default:()=>it},loading:{type:Boolean,default:!1}},setup(S){const n=S,_=a=>{a.preventDefault()},{authEmail:p}=U(),$=x(()=>{if(!(n!=null&&n.spenders))return[];const a=n.spenders.map((o,e)=>({...o,position:e+1,active:o.email===p.value,name:(o==null?void 0:o.name)??(o==null?void 0:o.email)??""})),l=a.find(o=>o.email===p.value),r=a.slice(0,6),c=!!l&&r.some(o=>o.email===p.value);return l&&!c&&r.splice(r.length-1,1,l),r});return(a,l)=>{const r=K,c=W,o=X;return m(),B(o,null,{default:d(()=>[i(c,{class:"relative"},{default:d(()=>[l[0]||(l[0]=s("div",{class:"font-display text-3xl font-bold pb-4 border-b border-input"}," Top Spenders ",-1)),(m(!0),y(G,null,j(t($),(e,C)=>(m(),B(r,{key:e.user_id+e.email,value:e.user_id+e.email,onSelect:_},{default:d(()=>{var h;return[s("div",ct,[s("div",dt,[s("div",ut,[s("div",mt,b(e.position),1)]),i(rt,{initials:("getInitials"in a?a.getInitials:t(D))(e.name),class:"font-bold text-lg",style:O({backgroundColor:("getHexColor"in a?a.getHexColor:t(Q))(((h=e==null?void 0:e.name)==null?void 0:h.charAt(0))??"A"),color:"black"})},null,8,["initials","style"])]),s("div",_t,[s("div",null,b(e.name),1),e.active?(m(),y("div",pt,"You")):I("",!0)]),s("div",ft," â‚¦"+b(("formatMoney"in a?a.formatMoney:t(Y))((e==null?void 0:e.total)??0)),1)])]}),_:2},1032,["value"]))),128)),a.loading?(m(),y("div",vt,[i(t(J),{class:"size-4 animate-spin"})])):I("",!0)]),_:1})]),_:1})}}}),ht={class:"container pb-20"},xt={class:"place-center text-center grid place-items-center gap-4"},yt={class:"text-destructive text-clip"},bt={class:"grid grid-cols-1 lg:grid-cols-[1fr_400px] gap-x-20 gap-y-6 mt-20"},$t={class:"absolute w-[450px] h-0 overflow-hidden"},kt={class:"flex justify-center my-4"},Vt=w({__name:"request-receipt",setup(S){var T;const n=Z(),{data:_,status:p,error:$}=k(`events/${n.params.event_id}`),a=((T=n==null?void 0:n.query)==null?void 0:T.reference)??"",{data:l,status:r,error:c,refresh:o}=k(`transactions/${a}/verify`),{data:e,status:C,refresh:h}=k(`/events/top/spenders/${n.params.event_id}?includeLiveEvent=1`);tt(()=>r.value,async f=>{await lt(300),f==="success"&&h()},{immediate:!0});const q=x(()=>p.value==="pending"||r.value==="pending"),A=x(()=>$.value??c.value),F=n.params.request_id,E=x(()=>{var f;return(f=_.value)==null?void 0:f.data.requests.find(u=>`${u.id}`==`${F}`)});return et({title:"Request Receipt"}),(f,u)=>{const z=H,M=st,P=at,V=nt;return m(),y("div",ht,[i(z,{class:"fixed top-20",to:`/${t(n).params.host}`},null,8,["to"]),i(V,{loading:t(q),error:t(A)},ot({default:d(()=>{var v,g,L;return[s("div",bt,[s("div",null,[i(R,{request:t(E),event:(v=t(_))==null?void 0:v.data},null,8,["request","event"]),s("div",$t,[i(R,{request:t(E),event:(g=t(_))==null?void 0:g.data,print:"",id:"RECEIPT_PRINT"},null,8,["request","event"])]),s("div",kt,[i(P,{to:`/${t(n).params.host}`,class:"underline hover:no-underline"},{default:d(()=>u[1]||(u[1]=[N(" CONTINUE ")])),_:1},8,["to"])])]),s("div",null,[i(gt,{loading:t(C)==="pending",spenders:((L=t(e))==null?void 0:L.data)??[]},null,8,["loading","spenders"])])])]}),_:2},[t(c)?{name:"error",fn:d(()=>{var v,g;return[s("div",xt,[s("div",yt,b(((g=(v=t(c))==null?void 0:v.data)==null?void 0:g.message)??"Payment verification failed"),1),i(M,{variant:"outline",onClick:t(o),loading:t(q)},{default:d(()=>u[0]||(u[0]=[N(" Confirm agai ")])),_:1},8,["onClick","loading"])])]}),key:"0"}:void 0]),1032,["loading","error"])])}}});export{Vt as default};
