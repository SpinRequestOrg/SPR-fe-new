import{_ as J}from"./CpdP7-94.js";import{h as H,j as S,o as l,c as v,a as t,P as z,n as s,Q as E,t as m,b as a,N as j,F as A,O as V,w as d,d as Y,p as F,v as D,_ as O,i as Q,$ as W,a0 as X,a1 as Z,L as G,W as K,Y as ee,Z as te,k as se,m as oe,a2 as ne}from"./CmKmz2PA.js";import{_ as ae}from"./C1Rx0Rvu.js";import{_ as ie}from"./WGa4iofq.js";import{_ as re}from"./BS0s6L4L.js";import{_ as le,m as de}from"./C9vdkHJK.js";import{_ as ce}from"./CQY-2ctE.js";import{u as ue,a as me,F as pe}from"./EF-D96hL.js";import{C as _e,a as fe}from"./MmhH76F6.js";import{u as ve}from"./Drjauvdg.js";import{_ as ge}from"./BVCDlKU-.js";import{u as P}from"./CFWrKVwL.js";import"./DNzFMpx1.js";import"./Cpj98o6Y.js";const ye={class:"font-display text-3xl font-medium capitalize"},he={class:"space-y-4 my-4"},xe={class:"py-4 px-6 grid grid-cols-[repeat(auto-fit,_minmax(300px,_1fr))] gap-4 border bg-white/5 rounded-2xl"},be={class:"space-y-1"},$e={class:"text-4xl font-semibold text-primary"},ke={class:"space-y-px"},qe={class:"font-medium"},Se={class:"grid grid-cols-[repeat(auto-fit,_minmax(300px,_1fr))] gap-4"},Ce={class:"space-y-px"},we={class:"text-muted-foreground"},Ie={key:0,class:"grid grid-cols-[1fr,_auto,_auto,_auto] gap-4 items-center"},Te="https://dev.spinrequest.com",U=H({__name:"request-receipt-item",props:{request:{},event:{},print:{type:Boolean}},setup(L){const n=L,b=S(()=>{var _,f,u,q;const e={name:"Event",value:(_=n.event)==null?void 0:_.title},o={name:"Host",value:(f=n.request)==null?void 0:f.host.stage_name},k={name:"Location",value:(u=n.event)==null?void 0:u.address},w={name:"Date",value:ve((q=n.event)==null?void 0:q.start_date,"dddd, MMMM D, YYYY")};return[e,o,k,w]}),$=e=>{var o;pe.saveAs(e,`spin-request-receipt-${(o=n.event)==null?void 0:o.title}`)},{converting:I,convertNodeToImage:r}=ue("#RECEIPT_PRINT",$),g=S(()=>{var e,o;return`I just made a ${((e=n.request)==null?void 0:e.type)??"song"} request on SpinRequest. Join ${(o=n.request)==null?void 0:o.host.stage_name} live event to make yours.`}),p=S(()=>{var e;return`${Te}/${((e=n.request)==null?void 0:e.host.slug)??""}`}),{copyLink:y,copied:c,whatsappShareLink:i,twitterShareLink:R,externalNavigate:C}=me(p,g);return(e,o)=>{var u,q,N,B,M,h,x;const k=re,w=le,_=O,f=ce;return l(),v("div",{class:z(("cn"in e?e.cn:s(E))(" rounded-xl",e.print?"p-4 border-2 border-primary bg-background":"p-4 md:p-8 bg-white/5"))},[t("div",{class:z(("cn"in e?e.cn:s(E))("flex flex-col items-center gap-6",e.print?"":"md:flex-row md:justify-between"))},[t("div",{class:z(("cn"in e?e.cn:s(E))("text-center order-2",e.print?"":"md:text-left md:order-1"))},[t("div",ye,m((u=e.request)==null?void 0:u.type)+" Request receipt ",1),t("div",{class:z(("cn"in e?e.cn:s(E))("text-muted-foreground leading-tight my-2",e.print?"":"md:w-3/4"))},m(((q=e.request)==null?void 0:q.type)==="hype"?"Your request has been submitted, we will notify you when your hype has been performed":"Your request has been submitted, we will notify you when your song has been played"),3)],2),t("div",{class:z(("cn"in e?e.cn:s(E))("flex items-center shrink-0 text-primary gap-x-1 order-1",e.print?"":"md:order-2"))},[a(k,{name:"spin-logo"}),o[2]||(o[2]=t("div",{class:"text-base font-medium"},"SpinRequest",-1))],2)],2),t("div",he,[t("div",xe,[t("div",be,[o[3]||(o[3]=t("div",{class:"text-muted-foreground"},"Total amount",-1)),t("div",$e," ₦"+m(("formatMoney"in e?e.formatMoney:s(j))(((N=e.request)==null?void 0:N.price)??0)),1)]),t("div",ke,[((B=e.request)==null?void 0:B.type)==="hype"?(l(),v(A,{key:0},[o[4]||(o[4]=t("div",{class:"text-muted-foreground"},"Hype request for",-1)),a(w,{class:"font-medium",content:((M=e.request)==null?void 0:M.description)??""},null,8,["content"])],64)):(l(),v(A,{key:1},[o[5]||(o[5]=t("div",{class:"text-muted-foreground"},"Song title",-1)),t("div",qe,m(((h=e.request)==null?void 0:h.song_title)??""),1),t("div",null,"by "+m(((x=e.request)==null?void 0:x.artist)??""),1)],64))])]),t("div",Se,[(l(!0),v(A,null,V(s(b),T=>(l(),v("div",{class:"p-4 rounded-2xl bg-white/5 border",key:T.name},[t("div",Ce,[t("div",we,m(T.name),1),t("div",null,m(T.value),1)])]))),128))]),e.print?D("",!0):(l(),v("div",Ie,[a(_,{size:"lg",class:"uppercase",loading:s(I),onClick:s(r)},{default:d(()=>o[6]||(o[6]=[Y(" Download Receipt "),t("span",{class:"hidden md:inline ml-1"}," & loud IT",-1)])),_:1},8,["loading","onClick"]),a(f,{message:"Share to twitter/X"},{default:d(()=>[a(_,{size:"icon",variant:"secondary",class:"!size-[40px]",onClick:o[0]||(o[0]=T=>s(C)(s(R)))},{default:d(()=>[a(k,{name:"x"})]),_:1})]),_:1}),a(f,{message:"Share to whatsapp"},{default:d(()=>[a(_,{size:"icon",variant:"secondary",class:"!size-[40px]",onClick:o[1]||(o[1]=T=>s(C)(s(i)))},{default:d(()=>[a(k,{name:"whatsapp",class:"scale-[0.7]"})]),_:1})]),_:1}),a(f,{message:"Copy link"},{default:d(()=>[a(_,{size:"icon",variant:"secondary",class:"!size-[40px]",onClick:s(y)},{default:d(()=>[s(c)?(l(),F(s(_e),{key:0,class:"text-muted-foreground size-4"})):(l(),F(s(fe),{key:1,class:"text-muted-foreground size-4"}))]),_:1},8,["onClick"])]),_:1})]))])],2)}}}),ze={class:"grid grid-cols-[40px,_1fr,_150px] gap-4 items-center my-8"},Ee={class:"space-y-px"},Le={key:0,class:"text-[#FFEE99]"},Re={class:"flex gap-x-4 items-center"},Ne={class:"relative bg-foreground size-[30px] rounded-full"},Be={class:"place-center text-lg font-bold text-background"},Me={class:"font-semibold"},Ae={key:0,class:"py-20 absolute -top-2 inset-0 grid place-items-center"},Fe=H({__name:"event-top-spenders",props:{spenders:{default:()=>de},loading:{type:Boolean,default:!1}},setup(L){const n=L,b=r=>{r.preventDefault()},{authEmail:$}=Q(),I=S(()=>{if(!(n!=null&&n.spenders))return[];const r=n.spenders.map((c,i)=>({...c,position:i+1,active:c.email===$.value})),g=r.find(c=>c.email===$.value),p=r.slice(0,6),y=!!g&&p.some(c=>c.email===$.value);return g&&!y&&p.splice(p.length-1,1,g),p});return(r,g)=>{const p=K,y=ee,c=te;return l(),F(c,null,{default:d(()=>[a(y,{class:"space-y-2 relative"},{default:d(()=>[g[0]||(g[0]=t("div",{class:"font-display text-3xl font-bold pb-4 border-b border-input mb-4"}," Top Spenders ",-1)),(l(!0),v(A,null,V(s(I),(i,R)=>(l(),F(p,{key:i.user_id+i.email,value:i.user_id+i.email,onSelect:b},{default:d(()=>{var C;return[t("div",ze,[a(ge,{initials:("getInitials"in r?r.getInitials:s(W))(i.name),class:"font-bold text-lg",style:X({backgroundColor:("getHexColor"in r?r.getHexColor:s(Z))(((C=i==null?void 0:i.name)==null?void 0:C.charAt(0))??"A"),color:"black"})},null,8,["initials","style"]),t("div",Ee,[t("div",null,m(i.name),1),i.active?(l(),v("div",Le,"You")):D("",!0)]),t("div",Re,[t("div",Ne,[t("div",Be,m(i.position),1)]),t("div",Me," ₦"+m(("formatMoney"in r?r.formatMoney:s(j))((i==null?void 0:i.total)??0)),1)])])]}),_:2},1032,["value"]))),128)),r.loading?(l(),v("div",Ae,[a(s(G),{class:"size-4 animate-spin"})])):D("",!0)]),_:1})]),_:1})}}}),Pe={class:"container pb-20"},Ye={class:"place-center text-center grid place-items-center gap-4"},De={class:"text-destructive"},He={class:"grid grid-cols-1 lg:grid-cols-[1fr_400px] gap-x-20 gap-y-6 mt-20"},Ue={class:"absolute w-[450px] h-0 overflow-hidden"},je={class:"flex justify-center my-4"},at=H({__name:"request-receipt",setup(L){var _;const n=se(),{data:b,status:$,error:I}=P(`events/${n.params.event_id}`),r=((_=n==null?void 0:n.query)==null?void 0:_.reference)??"",{data:g,status:p,error:y,refresh:c}=P(`transactions/${r}/verify`),{data:i,status:R,error:C}=P(`/events/top/spenders/${n.params.event_id}`),e=S(()=>$.value==="pending"||p.value==="pending"),o=S(()=>I.value??y.value),k=n.params.request_id,w=S(()=>{var f;return(f=b.value)==null?void 0:f.data.requests.find(u=>`${u.id}`==`${k}`)});return oe({title:"Request Receipt"}),(f,u)=>{const q=J,N=O,B=ae,M=ie;return l(),v("div",Pe,[a(q,{class:"fixed top-20",to:`/${s(n).params.host}`},null,8,["to"]),a(M,{loading:s(e),error:s(o)},ne({default:d(()=>{var h,x;return[t("div",He,[t("div",null,[a(U,{request:s(w),event:(h=s(b))==null?void 0:h.data},null,8,["request","event"]),t("div",Ue,[a(U,{request:s(w),event:(x=s(b))==null?void 0:x.data,print:"",id:"RECEIPT_PRINT"},null,8,["request","event"])]),t("div",je,[a(B,{to:`/${s(n).params.host}`,class:"underline hover:no-underline"},{default:d(()=>u[1]||(u[1]=[Y(" CONTINUE ")])),_:1},8,["to"])])]),t("div",null,[a(Fe,{loading:s(R)==="pending"},null,8,["loading"])])])]}),_:2},[s(y)?{name:"error",fn:d(()=>{var h,x;return[t("div",Ye,[t("div",De,m(((x=(h=s(y))==null?void 0:h.data)==null?void 0:x.message)??"Payment verification failed"),1),a(N,{variant:"outline",onClick:s(c),loading:s(e)},{default:d(()=>u[0]||(u[0]=[Y(" Confirm again ")])),_:1},8,["onClick","loading"])])]}),key:"0"}:void 0]),1032,["loading","error"])])}}});export{at as default};
